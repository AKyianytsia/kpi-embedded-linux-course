======================
Лабораторная работа №1
======================

**Задание:**

1. Написать программу, которая:
* Содержит глобальную переменную (изначально инициализируется значением ``0``);
* Запускает два потока pthread;
* Каждый поток в цикле инкрементирует значение глобальной переменной 100 000 раз;
* Дожидается завершения потоков, используя ``join``, и выводит значения;
2. Собрать с флагами оптимизации ``-O0`` и ``-O2`` на **х86** и **BBXM**.
3. Сравнить полученные результаты.

----------------------------------

**Порядок выполнения работы**

1. Для начала нужно разархивировать на SD-карту образ  Debian Stretch for BeagleBoard.
.. code-block::

  sudo sh -c "xz --decompress --keep --stdout bbxm-debian.img.xz | dd status=progress bs=4M of=/dev/mmcblk1; sync"

2. Вставляем SD-карту в BBXM и подключаем питание.

3. Убедимся, что софтверный USB-хаб ID 1d6b:0104 Linux Foundation Multifunction Composite Gadget присутствует в выводе lsusb и соответствующий сетевой интерфейс был распознан и добавлен.
.. code-block::

	lsusb
	ip link show

4. Дистрибутив BBXM реализует DHCP-сервер. При подключении сетевого интерфейса, компьютер должен сам получить IP-адрес по DHCP. Поскольку этого не произошло пришлось в ручную настроить IP-адрес (192.168.7.1/24).
Дальше проверим, что сетевые пакеты доходят:
.. code-block::
	
	ping 192.168.7.2

5. Подключаемся к BBXM по ssh. По-умолчанию логин – ``debian``, пароль – ``temppwd``
.. code-block::
	
	ssh debian@192.168.6.2

6. С помощью ssh копируем файлы кода на BBXM и запускаем программу.
подключился к плате.
Для подмонтирования папки с пк к ВВХМ:
.. code-block::
	sudo sshfs -o allow_other debian@192.168.7.2:/home/debian/build /home/ra7e/work 
	sshfs debian@192.168.7.2:/home/debian/build /home/HL36/work

Переносим необходимые файлы в ``/home/HL36/work``, и запускаем на BBXM.



----------------------------------------------------------

**Плученные результаты**

*В результате подсчета с флагом -O0:*
Итоговое значение переменной равно 100 001
На BBXM это заняло 4 518 494 мкс.
*В результате подсчета с флагом -О2:*
Итоговое значение переменной равно 100 001
НА ВВХМ это заняло 4 521 271 мкс.

-----------------------------------------------------------

**Вывод:**

В результате того что два потока используют одновременно одну и ту же глобальную переменную возникают ошибки, из за чего переменная инкрементируется больше раз чем должна. Одним из вариантов исправления этой ошибки есть использование временных задержек.